# GPG Agent configuration
# This file should be symlinked or copied to ${GNUPGHOME}/gpg-agent.conf
# GNUPGHOME is typically ${XDG_DATA_HOME}/gnupg

# Pinentry program configuration
# Try GUI pinentry first, fallback to loopback mode for non-interactive environments
pinentry-program /usr/bin/pinentry-gnome3
{{- if lookPath "brew" -}}
{{-     if eq .chezmoi.os "darwin" -}}
pinentry-program {{ env "HOMEBREW_PREFIX" }}/bin/pinentry-mac
{{-     else -}}
pinentry-program {{ env "HOMEBREW_PREFIX" }}/bin/pinentry
{{-     end -}}
{{- else if eq .chezmoi.os "linux" -}}
pinentry-program /usr/bin/pinentry-gnome3
{{- end }}

# Enable loopback mode for non-interactive environments (like IDEs)
# This allows gpg-agent to prompt for passphrase via stdin when GUI pinentry isn't available
allow-loopback-pinentry

# Cache passphrase for 1 hour (3600 seconds)
default-cache-ttl 3600
max-cache-ttl 3600

# Enable SSH agent support (optional, but useful)
enable-ssh-support
